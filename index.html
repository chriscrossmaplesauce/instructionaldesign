<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lesson Planner - Version 2 Beautiful</title>
<style>
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background:#f3f4f6; margin:0; padding:20px; color:#1f2937; }
.container { max-width:1100px; margin:auto; background:white; padding:20px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1);}
h1,h2,h3,h4{margin-top:0;}
.card { border-radius:10px; padding:16px; margin:12px 0; cursor:pointer; transition:transform 0.2s, box-shadow 0.2s; background:#ffffff; border-left:8px solid #4f46e5; box-shadow:0 1px 4px rgba(0,0,0,0.08);}
.card:hover { transform: scale(1.03); box-shadow:0 4px 12px rgba(0,0,0,0.15); }
textarea { width:100%; min-height:70px; border-radius:8px; border:1px solid #d1d5db; padding:8px; margin:6px 0; resize:vertical; font-family:inherit; }
input[type=text] { border-radius:6px; border:1px solid #d1d5db; padding:6px; width:100%; font-family:inherit; }
.button { background:#4f46e5; color:white; padding:10px 18px; border:none; border-radius:10px; cursor:pointer; margin:6px 0; font-size:14px; }
.button:hover { background:#4338ca; }
.lesson-event { border:1px solid #e5e7eb; padding:12px; margin:10px 0; border-radius:10px; background:#f9fafb; display:flex; gap:12px; align-items:flex-start; }
.event-controls { display:flex; flex-wrap:wrap; gap:10px; margin-top:6px; align-items:flex-start; }
.suggestions { background:#eef2ff; padding:8px 12px; border-left:5px solid #4f46e5; border-radius:6px; margin-top:6px; }
.suggestions li { cursor:pointer; color:#4f46e5; margin-bottom:3px; display:inline-block; padding:4px 8px; border-radius:6px; background:#e0e7ff; }
.suggestions li:hover { background:#c7d2fe; text-decoration:none; }
.drag-handle { cursor:grab; font-size:20px; margin-right:10px; user-select:none; }
#return-btn { margin-bottom:16px; }
.media-label { display:flex; align-items:center; gap:4px; background:#f3f4f6; padding:4px 8px; border-radius:6px; font-size:13px; }
@media (max-width:600px){ .event-controls{flex-direction:column;} }
</style>
</head>
<body>
<div class="container">
<h1>üìö Lesson Planner - Version 2 Beautiful</h1>
<button id="surprise-btn" class="button">üé≤ Surprise Me!</button>
<button id="return-btn" class="button" style="display:none;">üè† Return to Main Page</button>
<div id="topic-selector"></div>
<div id="lesson-planner" style="display:none;"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

<script>
// Topics
const topics=[
  {name:"Life Cycles of Butterflies", subject:"Science", objectives:["Identify four stages of a butterfly life cycle","Sequence egg, caterpillar, chrysalis, butterfly","Describe what happens at each stage"], content:{stages:["Egg: laid on leaves","Caterpillar: eats & grows","Chrysalis: protective casing","Butterfly: adult emerges"]}, suggestions:{1:["Show time-lapse","Ask if seen butterflies","Play butterfly music"],2:["Display objectives","Repeat aloud","Explain goal"],3:["Recall other insects","Discuss caterpillar stages","Show short insect video"],4:["Present images","Explain terms","Show diagram"],5:["Use model","Sequence cards","Draw together"],6:["Draw life cycle","Label stages","Matching activity"],7:["Feedback","Correct misconceptions","Praise effort"],8:["Quiz","Explain to partner","Oral recap"],9:["Worksheet","Outdoor observation","Keep journal"]}},
  {name:"Plant Parts", subject:"Science", objectives:["Name roots, stem, leaves, flowers","Explain job of each part","Identify on real plants/pictures"], content:{parts:["Roots absorb water","Stem supports & transports","Leaves make food","Flowers produce seeds"]}, suggestions:{1:["Show plant video","Ask what plants need","Bring plant"],2:["Display objectives","Read aloud","Explain usefulness"],3:["Ask known parts","Discuss favorites","Show leaves"],4:["Show diagrams","Explain functions","Cross-section"],5:["Show real parts","Guide touching","Use magnifying glass"],6:["Label worksheet","Draw & color","Assemble cut-out"],7:["Feedback","Correct mistakes","Praise"],8:["Quick questions","Short quiz","Match parts"],9:["Observe at home","Record changes","Start journal"]}},
  {name:"Healthy Foods", subject:"Health", objectives:["Sort foods healthy/less healthy","Identify food groups","Explain why healthy foods help growth"], content:{foodGroups:["Fruits: vitamins","Vegetables: growth","Proteins: muscles","Grains: energy","Dairy: bones & teeth"]}, suggestions:{1:["Show pictures","Ask what they ate","Play song"],2:["Display objectives","Read aloud","Explain importance"],3:["Ask favorite foods","Discuss healthy","Recall last meal"],4:["Present groups","Explain role","Use pyramid"],5:["Sort pictures","Make posters","Guide grouping"],6:["Classify cards","Create meal plans","Plate sorting"],7:["Feedback","Correct mistakes","Praise"],8:["Quiz","Explain why healthy","Matching game"],9:["Food diary","Track weekly","Family challenge"]}},
  {name:"Do-It-Yourself", subject:"Custom", objectives:["Enter your lesson objectives here..."], content:{customContent:["Enter key content here..."]}, suggestions:{1:["Add creative element","Group work","Link real-life"],2:["Add creative element","Group work","Link real-life"],3:["Add creative element","Group work","Link real-life"],4:["Add creative element","Group work","Link real-life"],5:["Add creative element","Group work","Link real-life"],6:["Add creative element","Group work","Link real-life"],7:["Add creative element","Group work","Link real-life"],8:["Add creative element","Group work","Link real-life"],9:["Add creative element","Group work","Link real-life"]}}
];

// Gagn√© Events
const nineEvents=[{id:1,title:"Gaining Attention"},{id:2,title:"Informing Learners of Objectives"},{id:3,title:"Stimulating Recall"},{id:4,title:"Presenting Content"},{id:5,title:"Providing Learning Guidance"},{id:6,title:"Eliciting Performance"},{id:7,title:"Providing Feedback"},{id:8,title:"Assessing Performance"},{id:9,title:"Enhancing Retention"}];

let selectedTopic=null;

// Render topics
function renderTopics(){
  const container=document.getElementById("topic-selector"); container.innerHTML=""; container.style.display="block";
  document.getElementById("lesson-planner").style.display="none"; document.getElementById("return-btn").style.display="none";
  topics.forEach(topic=>{
    const div=document.createElement("div"); div.className="card";
    div.innerHTML=`<h3>${topic.name}</h3><p>${topic.subject}</p><p><strong>Objective:</strong> ${topic.objectives[0]}</p>`;
    div.addEventListener("click",()=>{ selectedTopic=topic; showPlanner(); });
    container.appendChild(div);
  });
}
renderTopics();

// Surprise Me
document.getElementById("surprise-btn").addEventListener("click",()=>{
  selectedTopic=topics[Math.floor(Math.random()*topics.length)]; showPlanner();
});

// Return to main page
document.getElementById("return-btn").addEventListener("click",()=>{ renderTopics(); });

// Show planner
function showPlanner(){
  const container=document.getElementById("lesson-planner"); container.innerHTML=""; container.style.display="block";
  document.getElementById("topic-selector").style.display="none"; document.getElementById("return-btn").style.display="inline-block";

  container.innerHTML=`<h2>Lesson Planner: ${selectedTopic.name}</h2>`;
  const objDiv=document.createElement("div"); objDiv.style.background="#eef2ff"; objDiv.style.padding="12px"; objDiv.style.borderRadius="8px"; objDiv.style.marginBottom="16px";
  if(selectedTopic.name==="Do-It-Yourself"){
    objDiv.innerHTML=`<p><strong>Objectives:</strong> <input type="text" id="custom_objectives" value="${selectedTopic.objectives[0]}"></p>
                        <p><strong>Key Content:</strong> <input type="text" id="custom_content" value="${selectedTopic.content.customContent[0]}"></p>`;
  } else {
    objDiv.innerHTML=`<p><strong>Objectives:</strong> ${selectedTopic.objectives.map(o=>"‚Ä¢ "+o).join("<br>")}</p>
                      <p><strong>Key Content:</strong> ${(selectedTopic.content.stages||selectedTopic.content.parts||selectedTopic.content.foodGroups).map(o=>"‚Ä¢ "+o).join("<br>")}</p>`;
  }
  container.appendChild(objDiv);

  const mediaOptions=["Video","Pictures","Charts","Physical Objects","Interactive Whiteboard","Worksheets","Songs/Audio","Role Play/Drama"];
  const eventsContainer=document.createElement("div"); eventsContainer.id="events-container"; container.appendChild(eventsContainer);

  nineEvents.forEach(event=>{
    const div=document.createElement("div"); div.className="lesson-event"; div.dataset.id=event.id; div.dataset.title=event.title;
    const suggestions=(selectedTopic.suggestions && selectedTopic.suggestions[event.id]) || ["Add activity 1","Add activity 2","Add activity 3"];
    div.innerHTML=`<span class="drag-handle">‚ò∞</span><div style="flex:1">
      <h4>${event.id}. ${event.title}</h4>
      <div class="event-controls">
        ${mediaOptions.map((m,i)=>`<label class="media-label"><input type="checkbox" data-index="${i}"> ${m}</label>`).join('')}
        <label class="media-label">Other: <input type="text" class="other-text" placeholder="Your idea"></label>
      </div>
      <div class="suggestions"><ul>${suggestions.map(s=>`<li>${s}</li>`).join('')}</ul></div>
      <textarea placeholder="How will you implement this?"></textarea>
    </div>`;
    eventsContainer.appendChild(div);

    const textarea=div.querySelector("textarea"); const checkboxes=div.querySelectorAll('input[type=checkbox]');
    const otherInput=div.querySelector(".other-text");
    textarea.value=localStorage.getItem(`lesson_${selectedTopic.name}_${event.id}`)||"";
    checkboxes.forEach((cb,i)=> cb.checked=(JSON.parse(localStorage.getItem(`lesson_${selectedTopic.name}_media_${event.id}`)||"[]").includes(i)));
    otherInput.value=JSON.parse(localStorage.getItem(`lesson_${selectedTopic.name}_media_${event.id}`)||"[]").find(m=>typeof m==="string")||"";

    // Autosave
    textarea.addEventListener("input",()=>{localStorage.setItem(`lesson_${selectedTopic.name}_${event.id}`,textarea.value);});
    checkboxes.forEach((cb,i)=>cb.addEventListener("change",saveMedia)); otherInput.addEventListener("input",saveMedia);
    function saveMedia(){ let selected=Array.from(checkboxes).map((cb,i)=>cb.checked?i:null).filter(x=>x!==null); if(otherInput.value.trim()!=="") selected.push(otherInput.value.trim()); localStorage.setItem(`lesson_${selectedTopic.name}_media_${event.id}`,JSON.stringify(selected)); }

    // Suggestions click
    div.querySelectorAll(".suggestions li").forEach(li=>li.addEventListener("click",()=>{textarea.value=li.textContent; localStorage.setItem(`lesson_${selectedTopic.name}_${event.id}`,textarea.value);}));
  });

  // Sortable
  new Sortable(eventsContainer,{handle:".drag-handle",animation:150});

  // Export PDF
  const exportBtn=document.createElement("button"); exportBtn.className="button"; exportBtn.textContent="üñ®Ô∏è Export to PDF";
  exportBtn.addEventListener("click",()=>{
    const { jsPDF }=window.jspdf; const doc=new jsPDF(); doc.setFontSize(16); doc.text(`Lesson Planner: ${selectedTopic.name}`,10,10);
    let startY=20; doc.setFontSize(12);
    if(selectedTopic.name==="Do-It-Yourself"){
      const customObj=document.getElementById('custom_objectives').value; const customCon=document.getElementById('custom_content').value;
      doc.text("Objectives:",10,startY); startY+=6; doc.text(customObj,12,startY); startY+=6;
      doc.text("Key Content:",10,startY); startY+=6; doc.text(customCon,12,startY); startY+=6;
    } else {
      doc.text("Objectives:",10,startY); startY+=6; selectedTopic.objectives.forEach(o=>{doc.text("‚Ä¢ "+o,12,startY); startY+=6;});
      doc.text("Key Content:",10,startY); startY+=6; (selectedTopic.content.stages||selectedTopic.content.parts||selectedTopic.content.foodGroups).forEach(o=>{doc.text("‚Ä¢ "+o,12,startY); startY+=6;});
    }

    const rows=Array.from(eventsContainer.children).map(div=>{
      const eventId=div.dataset.id; const title=div.dataset.title;
      const mediaSaved=JSON.parse(localStorage.getItem(`lesson_${selectedTopic.name}_media_${eventId}`)||"[]");
      const prescription=div.querySelector("textarea").value;
      const mediaLabels=mediaSaved.map(m=>typeof m==="string"?m:mediaOptions[m]).join(", ");
      return [title,mediaLabels,prescription];
    });

    doc.autoTable({startY:startY+6, head:[["Event","Media","Prescription"]], body:rows, styles:{fontSize:10,cellPadding:3}, headStyles:{fillColor:[100,149,237],textColor:255}, theme:'grid', columnStyles:{0:{cellWidth:50},1:{cellWidth:50},2:{cellWidth:90}}});
    doc.save(`${selectedTopic.name}_LessonPlanner.pdf`);
  });
  container.appendChild(exportBtn);
}
</script>
</div>
</body>
</html>
